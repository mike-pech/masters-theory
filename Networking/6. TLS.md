> Изначально трафик по умолчанию не шифровался. Проблема.
> 	 Но нам же нужно сетевое оборудование, чтобы посмотреть/ИЗМЕНИТЬ пакеты?
> Но всё равно неприятно, так как у нас всё ещё много векторов атак. IP-Адрес при ARP spoof-инге можно подменить и соединение будет установлено со злоумышленником
> 	А WiFi? Там нет коллизий
> Ничего не мешает их подслушивать. Это просто волны, которые распространяются во все стороны
## Спасение есть! TLS
### Коротенькая справка

> SSL (Secure Socket Layer) был изначально разработан в 1995 году, но спустя несколько версий и доработок в 1999 году был предложен более защищённый TLS (Transport Layer Security)
>
> По своей концепции SSL и TLS работают на слое представлений OSI или прикладном слое TCP/IP.
>	- При первоначальном соединении клиент и сервер обмениваются своими сертификатами, устанавливая безопасное соединение (HTTPS)
>	- Далее клиент и сервер соглашаются на максимально безопасный симметричный ключ и используют его для шифрования данных на одном конце соединения и дешифрования их на другом. Также применяются MAC-адреса на основе хэшей для удостоверения целостности полученных запросов и ответов
### Сертификаты

> Но что если злоумышленник попробует подделать пакеты в сообщении используя ваш публичный ключ?

Можно использовать сертификаты. Сейчас популярен Let's Encrypt — использование сертификатов — стандарт де факто

> Но что если злоумышленник перехватит DNS? 

Тогда надо смотреть на сами сертификаты. Представляем: Центры сертификации — Certificate Authorities — механизмы, которые подтверждают входящие сертификаты.

Корневой сертификат стоит в системе локально (имеет срок годности) и помогает подтвердить, что сертификаты подлинны

Но во избежание большого урона при компроментации секретного ключа корневого сертификата или центра сертификации — сертификация сегментируется. Корневой сертификат не единственный и делегирует свой авторитет другим сертификатам, которые распространяются по структуре дерева и наследуют его авторитет

Запрос на сертификат:
![[Pasted image 20251025091347.png]]

Далее его нужно подписать корневым сертификатом:
![[Pasted image 20251025091948.png]]

Проверим валидность:
![[Pasted image 20251025092027.png]]

Далее указываем этот сертификат в настройках nginx:
![[Pasted image 20251025092314.png]]
Указываем сертификат для клиента, ключ корневого сертификата и версии SSL, которые принимаем

При попытке посетить этот сайт, получаем ошибку — сертификата на системе нет и браузер ему не доверяет
![[Screenshot From 2025-10-25 09-25-29.png]]

Смотрим сертификат:
![[Pasted image 20251025092624.png]]

Поэтому скачиваем этот сертификат, ставим доверие и вот мы уже устанавливаем защищённое соединение с нашим сайтом
### Автоматизация получения сертификатов

При использовании Let's Encrypt мы можем использовать certbot для автоматического получения и обновления сертификатов получаемых от них

> Загугли Let's Encrypt certbot и не парься

После заполнения формы, бот запускает ACME challenge — проверка владения домена вами

![[Pasted image 20251025093904.png]]
Сертификат выписан Let's Encrypt, подписан их корневым сертификатом, промежуточным сертификатом и вот последнее — это сертификат нашего сайта