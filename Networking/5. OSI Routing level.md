Третий уровень модели OSI отвечает за маршрутизаицю пакетов по сети — пакеты передаются из точки A в точку B (первый уровень), делятся на фреймы (второй уровень), теперь их нужно направить
# Настройка маршрутизации

![[Pasted image 20251004082921.png]]
Допустим что у нас есть два офиса с двумя отделами — нам нужно соединить два маршрутизатора кабелем

Но роутер 1 не знает, что существует роутер 2. Как донести обеим сетям соответствующие топологии?
## Смотрим линки

`$ ip link show` покажет конфигурацию на втором уровне
![[Pasted image 20251004083630.png]]

`$ ip addr show` покажет интерфейсы
![[Pasted image 20251004083710.png]]

Соединим интерфейсы при помощи `sudo ip link add veth0 type veth peer name veth1` — соединяем типом `veth` — Virtual Ethernet

Первая машина соединится и будет пинговать другую, но не наоборот — нужно обменяться маршрутами

Поднимем IP-туннель `sudo ip tunnel add tun0 mode ipip remote {удалённый сервер} local {локальный адрес}` на обоих машинах соответственно

Поднимем туннель `sudo ip link set tun0 up`

Но пакеты всё ещё не летят. Потому что он не знает про нашу новую сеть, отправляет в дефолт и пакеты там теряются
## Маршрутизация

Добавим маршрут `sudo ip route add {удалённый сервер} dev tun0`, но пакеты всё ещё не идут. Что делать?
### RIP

Используем RIP — простой, не самый оптимизированный, но действенный протокол динамической маршрутизации

Ставим `rff`, включаем его демон в конфиге и в системе

Протокол RIP сильно ограничен ввиду примитивности принципа работы, и поэтому применим только для небольших сетей «на скорую руку»
### OSPF

Протокол на основе алгоритма Дейкстры, которому не нужно составлять таблицы